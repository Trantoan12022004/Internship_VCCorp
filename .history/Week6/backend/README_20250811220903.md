# Backend API - Task Management System

## Mô tả
Backend API cho hệ thống quản lý task với tính năng xác thực, thông báo và tích hợp Google Cloud.

## Yêu cầu hệ thống
- Node.js (v14 trở lên)
- npm hoặc yarn
- MongoDB
- Google Cloud Service Account (cho tính năng thông báo)

## Cài đặt

### 1. Clone repository và di chuyển vào thư mục backend
```bash
cd "Week6/backend"
```

### 2. Cài đặt dependencies
```bash
npm install
```

### 3. Cấu hình môi trường

Tạo file `.env` trong thư mục backend:
```env
# Database
MONGODB_URI=mongodb://localhost:27017/taskmanagement
DB_NAME=taskmanagement

# Server
PORT=3000
NODE_ENV=development

# JWT Secret
JWT_SECRET=your_jwt_secret_key_here

# Google Cloud (nếu sử dụng)
GOOGLE_APPLICATION_CREDENTIALS=./config/google-credentials.json
```

### 4. Cấu hình Google Cloud Credentials (Tùy chọn)

1. Tạo service account trên Google Cloud Console
2. Tải xuống file JSON credentials
3. Đặt file vào `config/google-credentials.json`

**Lưu ý**: File credentials đã được thêm vào `.gitignore` để bảo mật.

### 5. Cấu hình Database

Đảm bảo MongoDB đang chạy trên máy local hoặc cập nhật `MONGODB_URI` trong file `.env`.

## Khởi chạy ứng dụng

### Development mode
```bash
npm run dev
```

### Production mode
```bash
npm start
```

### Seed dữ liệu mẫu (nếu cần)
```bash
node seeder.js
```

## API Endpoints

### Authentication
- `POST /api/auth/login` - Đăng nhập
- `POST /api/auth/register` - Đăng ký

### Tasks
- `GET /api/tasks` - Lấy danh sách tasks
- `POST /api/tasks` - Tạo task mới
- `PUT /api/tasks/:id` - Cập nhật task
- `DELETE /api/tasks/:id` - Xóa task

## Testing

### Chạy test đơn giản
```bash
node quick-test.js
```

### Test thông báo
```bash
node test-notification.js
```

### Test Python (nếu có)
```bash
python test.py
```

## Cấu trúc thư mục

```
backend/
├── config/
│   ├── db.js                 # Cấu hình database
│   └── google-credentials.json # Google Cloud credentials
├── controllers/
│   └── taskController.js     # Logic xử lý tasks
├── middleware/
│   ├── authMiddleware.js     # Middleware xác thực
│   └── errorMiddleware.js    # Middleware xử lý lỗi
├── models/
│   ├── Task.js              # Model Task
│   └── Notification.js      # Model Notification
├── routes/
│   └── taskRoutes.js        # Routes cho tasks
├── .env                     # Biến môi trường
├── .gitignore              # Git ignore file
├── app.js                  # Cấu hình Express app
├── server.js               # Entry point
└── package.json            # Dependencies
```

## Scripts có sẵn

- `npm start` - Chạy server production
- `npm run dev` - Chạy server development với nodemon
- `node seeder.js` - Seed dữ liệu mẫu
- `node quick-test.js` - Test nhanh API
- `node test-notification.js` - Test tính năng thông báo

## Lưu ý bảo mật

1. **Không commit file credentials**: File `google-credentials.json` đã được thêm vào `.gitignore`
2. **Sử dụng biến môi trường**: Các thông tin nhạy cảm như JWT secret, database URI được lưu trong `.env`
3. **Cập nhật dependencies**: Thường xuyên kiểm tra và cập nhật các package để tránh lỗ hổng bảo mật

## Troubleshooting

### Lỗi kết nối database
- Kiểm tra MongoDB có đang chạy không
- Xác minh `MONGODB_URI` trong file `.env`

### Lỗi Google Cloud
- Kiểm tra file `google-credentials.json` có tồn tại không
- Xác minh service account có quyền cần thiết

### Port đã được sử dụng
- Thay đổi `PORT` trong file `.env`
- Hoặc dừng process đang sử dụng port 3000

## Liên hệ

Nếu gặp vấn đề, vui lòng tạo issue trên repository hoặc liên hệ team phát triển.